<form 
    [formGroup]="userForm" 
    (ngSubmit)="onSubmit()" 
    class="form-container"
>
    <!-- Fila 1: Nombre y Apellido -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 form-field">
        <fieldset>
            <label for="nombre" class="form-label">Nombre</label>
            <input
                type="text"
                id="nombre"
                placeholder="Ingrese el nombre"
                formControlName="nombre"
                class="form-input"
                [class.border-red-500]="getError('nombre')"
                [class.focus:ring-red-500]="getError('nombre')"
            >
            @if (getError('nombre')) {
                <p class="form-error">{{ getError('nombre') }}</p>
            }
        </fieldset>

        <fieldset>
            <label for="apellido" class="form-label">Apellido</label>
            <input
                type="text"
                id="apellido"
                placeholder="Ingrese el apellido"
                formControlName="apellido"
                class="form-input"
                [class.border-red-500]="getError('apellido')"
                [class.focus:ring-red-500]="getError('apellido')"
            >
            @if (getError('apellido')) {
                <p class="form-error">{{ getError('apellido') }}</p>
            }
        </fieldset>
    </div>

    <!-- Fila 2: Teléfono y Tipo de registro -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 form-field">
        <fieldset>
            <label for="telefono" class="form-label">Teléfono</label>
            <input
                type="text"
                id="telefono"
                placeholder="+54 9 223 123456"
                formControlName="telefono"
                class="form-input"
                [class.border-red-500]="getError('telefono')"
                [class.focus:ring-red-500]="getError('telefono')"
            >
            @if (getError('telefono')) {
                <p class="form-error">{{ getError('telefono') }}</p>
            }
        </fieldset>

        <fieldset>
            <label for="rolId" class="form-label">¿Cómo querés registrarte?</label>
            <select 
                id="rolId"
                formControlName="rolId" 
                class="form-input"
                [class.border-red-500]="userForm.get('rolId')?.invalid && userForm.get('rolId')?.touched"
            >
                <option value="" disabled selected>Seleccionar tipo</option>
                <option [value]="2">Cliente</option>
                <option [value]="3">Restaurante</option>
                <option [value]="4">Repartidor</option>
            </select>
            @if (userForm.get('rolId')?.touched && userForm.controls['rolId'].errors?.['required']) {
                <p class="form-error">*Obligatorio</p>
            }
        </fieldset>
    </div>

    <!-- Fila 3: Email (campo completo) -->
    <fieldset class="form-field">
        <label for="email" class="form-label">Email</label>
        <input
            type="email"
            id="email"
            placeholder="Ingresa tu email"
            formControlName="email"
            class="form-input"
            [class.border-red-500]="getError('email')"
            [class.focus:ring-red-500]="getError('email')"
        >
        @if (getError('email')) {
            <p class="form-error">{{ getError('email') }}</p>
        }
    </fieldset>

    <!-- Fila 4: Contraseña (campo completo) -->
    <fieldset class="form-field">
        <label for="password" class="form-label">Contraseña</label>
        <div class="relative">    
            <input
                [type]="showPassword ? 'text' : 'password'"
                id="password"
                placeholder="Ingresa tu contraseña"
                formControlName="password"
                class="form-input"
                [class.border-red-500]="getError('password')"
                [class.focus:ring-red-500]="getError('password')"
            >
            <button
                type="button"
                (click)="togglePasswordVisibility()"
                class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700"
                tabindex="-1"
            >
                @if (showPassword) {
                    <!-- Icono ojo cerrado -->
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                } @else {
                    <!-- Icono ojo abierto -->
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                }
            </button>
        </div>
        @if (getError('password')) {
            <p class="form-error">{{ getError('password') }}</p>
        }
    </fieldset>
    <!-- Fila 4: Confirmar contraseña (campo completo) -->
    <fieldset class="form-field">
        <label for="password2" class="form-label">Confirmar contraseña</label>
        <div class="relative">
            <input 
                [type]="showPassword2 ? 'text' : 'password'" 
                id="password2" 
                placeholder="Ingresa nuevamente tu contraseña"
                formControlName="password2" 
                class="form-input"
                [class.border-red-500]="getError('password2')"
                [class.focus:ring-red-500]="getError('password2')"
            >        <button
                type="button"
                (click)="togglePassword2Visibility()"
                class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700"
                tabindex="-1"
            >
                @if (showPassword2) {
                    <!-- Icono ojo cerrado -->
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                } @else {
                    <!-- Icono ojo abierto -->
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                }
            </button>
        </div>
        @if (getError('password2')) {
            <p class="form-error">{{ getError('password2') }}</p>
        }
    </fieldset>

    <!-- Botón de submit -->
    <div style="margin-top: 24px;">
        <button 
            type="submit" 
            [disabled]="userForm.invalid || isSubmitting()" 
            class="form-button"
        >
            @if (isSubmitting()) {
                <span class="inline-flex items-center justify-center gap-2">
                    <span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>
                    Registrando...
                </span>
            } @else {
                Registrarse
            }
        </button>
    </div>

    <!-- Link a login -->
    <div class="text-center" style="margin-top: 20px;">
        <p class="text-stone-700" style="font-size: 14px;">
            ¿Ya tenés cuenta? 
            <a 
                routerLink="/login" 
                class="font-semibold hover:underline transition-colors"
                style="color: #E3291D;"
            >
                Iniciá sesión aquí
            </a>
        </p>
    </div>
</form>