@if (tieneItems()) {
  <div class="fixed bottom-6 right-6 z-50 flex flex-col items-end gap-3">
    
    <!-- Panel expandido con resumen -->
    @if (expandido) {
      <div class="bg-white rounded-2xl shadow-2xl p-4 w-80 animate-in slide-up">
        <!-- Header -->
        <div class="flex items-center justify-between mb-3 pb-3 border-b border-gray-200">
          <h3 class="font-bold text-gray-900">Mi Carrito</h3>
          <button 
            (click)="toggleExpandir()"
            class="text-gray-500 hover:text-gray-700">
            <mat-icon>close</mat-icon>
          </button>
        </div>
        
        <!-- Restaurante -->
        @if (restauranteActual()) {
          <div class="mb-3 flex items-center gap-2">
            <mat-icon class="text-primary-600 text-sm">restaurant</mat-icon>
            <span class="text-sm text-gray-700">{{ restauranteActual()!.nombre }}</span>
          </div>
        }
        
        <!-- Resumen -->
        <div class="space-y-2 mb-4">
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600">{{ cantidadTotal() }} productos</span>
            <span class="font-semibold text-gray-900">
              ${{ total() | number:'1.2-2' }}
            </span>
          </div>
        </div>
        
        <!-- Botones -->
        <div class="space-y-2">
          <button 
            (click)="irACheckout()"
            class="w-full py-3 rounded-xl bg-primary-600 hover:bg-primary-700
                   text-white font-semibold transition-colors">
            Finalizar Compra
          </button>
          <button 
            (click)="irAlCarrito()"
            class="w-full py-2 rounded-xl border-2 border-primary-600
                   text-primary-600 font-semibold hover:bg-primary-50 transition-colors">
            Ver Carrito
          </button>
        </div>
      </div>
    }
    
    <!-- Botón flotante principal -->
    <button 
      (click)="toggleExpandir()"
      class="relative w-16 h-16 bg-linear-to-br from-primary-600 to-primary-700
             hover:from-primary-700 hover:to-primary-800
             text-white rounded-full shadow-2xl 
             transition-all duration-300 hover:scale-110
             flex items-center justify-center group">
      
      <!-- Ícono -->
      <mat-icon class="text-3xl">shopping_cart</mat-icon>
      
      <!-- Badge de cantidad -->
      <span class="absolute -top-2 -right-2 w-8 h-8 
                   bg-red-500 text-white rounded-full 
                   flex items-center justify-center text-sm font-bold
                   shadow-lg animate-pulse">
        {{ cantidadTotal() }}
      </span>
      
      <!-- Ripple effect -->
      <span class="absolute inset-0 rounded-full 
                   bg-primary-600 opacity-0 group-hover:opacity-20
                   animate-ping"></span>
    </button>
  </div>
}