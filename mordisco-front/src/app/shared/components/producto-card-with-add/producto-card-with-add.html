<article class="bg-white rounded-xl shadow-md overflow-hidden 
                transition-all duration-300 hover:shadow-xl hover:-translate-y-1
                flex flex-col h-full group">
  
  <!-- Imagen del producto -->
  <div class="relative aspect-square overflow-hidden bg-gray-200">
    <img 
      [src]="producto()!.imagen.url" 
      [alt]="producto()!.nombre"
      class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110">
    
    <!-- Badge de descuento -->
    @if (producto()!.tienePromocion && producto()!.porcentajeDescuento) {
      <div class="absolute top-3 left-3 px-3 py-2 rounded-lg 
                  bg-red-500 text-white text-sm font-bold shadow-lg
                  flex items-center gap-1">
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
        </svg>
        -{{ producto()!.porcentajeDescuento | number:'1.0-0' }}%
      </div>
    }
    
    <!-- Badge si está en el carrito -->
    @if (enCarrito()) {
      <div class="absolute top-3 right-3 px-3 py-1 rounded-full 
                  bg-green-500 text-white text-xs font-bold shadow-lg">
        En carrito ({{ cantidad() }})
      </div>
    }
  </div>

  <!-- Info del producto -->
  <div class="flex flex-col flex-1 p-4">
    <!-- Nombre -->
    <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2 min-h-14">
      {{ producto()!.nombre }}
    </h3>
    
    <!-- Descripción -->
    @if (producto()!.descripcion) {
      <p class="text-sm text-gray-600 mb-3 line-clamp-2">
        {{ producto()!.descripcion }}
      </p>
    }
    
    <!-- Precio y botón -->
    <div class="mt-auto pt-3 border-t border-gray-200">
      <div class="flex items-center justify-between">
        <div class="flex-1">
          @if (producto()!.tienePromocion && producto()!.precioConDescuento) {
            <!-- Con promoción -->
            <p class="text-xs text-gray-500 mb-1">Precio</p>
            <div class="flex flex-col gap-1">
              <p class="text-sm text-gray-400 line-through">
                ${{ producto()!.precio | number:'1.2-2' }}
              </p>
              <div class="flex items-baseline gap-2">
                <p class="text-2xl font-bold text-red-600">
                  ${{ producto()!.precioConDescuento | number:'1.2-2' }}
                </p>
              </div>
              <p class="text-xs text-green-600 font-medium">
                Ahorrás ${{ (producto()!.precio - producto()!.precioConDescuento!) | number:'1.2-2' }}
              </p>
            </div>
          } @else {
            <!-- Sin promoción -->
            <p class="text-xs text-gray-500">Precio</p>
            <p class="text-2xl font-bold text-primary-600">
              ${{ producto()!.precio | number:'1.2-2' }}
            </p>
          }
        </div>
        @if(!adminMode()){
          <button 
            (click)="onAgregar()"
            [disabled]="!producto()!.disponible"
            class="w-12 h-12 rounded-full bg-primary-600 hover:bg-primary-700
                  disabled:bg-gray-300 disabled:cursor-not-allowed
                  text-white flex items-center justify-center
                  transition-all duration-200 hover:scale-110 active:scale-95">
            <mat-icon>{{ enCarrito() ? 'add' : 'add_shopping_cart' }}</mat-icon>
          </button>
        }
      </div>
    </div>
  </div>
</article>